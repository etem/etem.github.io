---
layout: post
title:  "EVE-NG - свързване към външни мрежи/интернет"
date:   2017-06-21 18:40:00
comments : true
categories: networking
published: false
---

[EVE-NG](http://www.eve-ng.net/) е новото име на известният мрежов емулатор Unetlab.

Аз го използвам от сравнително скоро и ми хареса. Доста по-лек е от GNS3 и удобен за използване. Технически погледнато EVE-NG е една виртуална машина с инсталирано Ubuntu + tools като qemu, dynamips и т.н.

Без на навлизам в повече детайли ще се спра в най-интересната част на цялото упражнение - свързване към LAB-а външни мрежи или в общия - интернет. 

Та цялата философия е следната : 

1. Нужно е да се създаде някаква виртуална мрежа, която ще използва за връзка между EVE-NG и хост машината. За целта може да се използва VMware Virtual Network Editor : 

![VMnet](https://github.com/etem/etem.github.io/raw/master/assets/images/vmnetwork.png)

За предпочитане е да има NAT + DHCP или някакъв bridge с физическите адаптери на хост машината. Според мен първото е по-добра идея, най-малкото не е толкова объркващо. 

И така, след създаване на виртуалната мрежа удряме на първия камък :) 
По подразбиране мрежите на VMware се създават с права 600 за root: 

**➜  ~ ll /dev/vmnet11**
**crw-------. 1 root root 119, 11 21 юни 15,30 /dev/vmnet11**


В което вероятно има някакъв замисъл, но за да проработят нещата трябва текущия потребител, с който стартираме VMware да има права върху мрежата. Един от начините да решим проблема, е чрез редактирането на init скрипта на VMware  - **/etc/init.d/vmware**. Някъде във функцията **vmwareService()** добавяме if условиe, коeто ще проверява дали определената мрежа съществува, и ако е така ще задава правата към съответния потребител. Пример : 

<code>
         if [ -e /dev/vmnet11 ]; then
                 chown bavarian:bavarian /dev/vmnet11
         fi

</code>

След промените в скрипта е нужно да се рестартира услугата : 

**systemctl daemon-reload**
**service vmware restart**


Естествено може директно да се изпълни **chown user:user** върху мрежата, но варианта с редактирането на скрипта ще ви спаси писането на командата следващия път :)  







Оказа се че при EVE-NG, oсобено под Linux с VMware Workstation това е е толкова проста задача. 
Първия камък на който ударих, беше че по подразбиране виртуалните мрежи на VMware - vmnet1,vmnet2 и т.н. се създават с права 600 за root. Което си е логично и вероятно има някакъв замисъл 